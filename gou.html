<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>;_;</title>
	<script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
	<link rel="stylesheet" type="text/css" href="main.css">
	<link rel="shortcut icon" href="assets/favicon.ico">
	<style>
		.chaplist {
			list-style: none;
		}

		.chaplist li {
			display: inline-block;
		}

		#content button, #content a {
			color: crimson;
			margin: 5px 0;
		}

		.chaplist button {
			display: inline-block;
			padding: 10px 15px;
			margin: 5px 0;
			text-decoration: none;
			border: 1px solid gray;
			background-color: #282525;
			text-align: center;
			min-width: 120px;
			color: #D6D1D1!important;
			-webkit-transition: background-color ease-in .1s,
						border-color ease-in .1s;
			transition: background-color ease-in .1s,
						border-color ease-in .1s;
		}

		.chaplist button:hover {
			background-color: #1F1F1F;
			border-color: #ddd;
			-webkit-transition: background-color ease-in .1s,
						border-color ease-in .1s;
			transition: background-color ease-in .1s,
						border-color ease-in .1s;
		}

		#main h3, #main p {
			margin: 5px 0;
		}

		#main hr {
			color: #766F6F;
		}

		#cover {
			display: block;
    		float: left;
			width: 200px;
			min-height: 300px;
			margin-right: 40px;
		}

		#cover img {
			width: inherit;
			display: block;
			margin-bottom: 15px;
			box-shadow: rgba(0, 0, 0, 0.6) 0px 8px 24px;
		}

		.chaplist .date {
			float: right;
			margin: 0 20px;
		}

		#content h2 {
			margin: 0;
			padding-top: 15px;
			text-transform: uppercase;
			font-weight: 600;
			font-family: 'Fira Sans', sans-serif;
		}

		#chapters p {
			margin: 10px 0;
		}

		#chapters {
			height: auto;
			padding: 5px;
		}
	</style>
</head>
<body>
	<main>
		<section id="side"></section>
		<section id="main">
			<header>
				<button id="navtoggle">&gt;&gt;</button>
				<h1>When The <span>Tra</span>nslators Cry...</h1>
			</header>
			<div id="content">
				<div id="cover">
					<img src="https://static.wikia.nocookie.net/umineko/images/c/c6/HigurashiGouVol2.jpg" title="Vol.2 cover">
				</div>
				<h2>Higurashi no Naku Koro ni Gou</h2>
				<h3>ひぐらしのなく頃に 業</h3>
				<a href="https://web-ace.jp/youngaceup/contents/1000147/episode/">web-ace.jp</a><br>
				<p>Author: <strong>Ryukishi07</strong></p>
				<p>Status: <strong>Ongoing</strong> (New chapter releases: <strong id="countdown"></strong>)</p><br>
				
				<section id="chapters">
					<h3>Chapter list</h3>
					<hr/>
					<p>Nekodamashi-hen</p>
					<ul class="chaplist">
						<li><button class="read" data="gou&13">Chapter 13-1</button></li>
					</ul>
					<p>Tataridamashi-hen</p>
					<ul class="chaplist">
						<li><button class="read" data="gou&12">Chapter 12</button></li>
						<li><button class="read" data="gou&11">Chapter 11</button></li>
						<li><button class="read" data="gou&10">Chapter 10</button></li>
						<li><button class="read" data="gou&9">Chapter 9</button></li>
						<li><button class="read" data="gou&8">Chapter 8</button></li>
					</ul>
					<p>Watadamashi-hen</p>
					<ul class="chaplist">
						<li><button class="read" data="gou&7">Chapter 7</button></li>
						<li><button class="read" data="gou&6">Chapter 6</button></li>
						<li><button class="read" data="gou&5">Chapter 5</button></li>
						<li><button class="read" data="gou&4">Chapter 4</button></li>
					</ul>
					<p>Onidamashi-hen</p>
					<ul class="chaplist">
						<li><button class="read" data="gou&3">Chapter 3</button></li>
						<li><button class="read" data="gou&2">Chapter 2</button></li>
						<li><button class="read" data="gou&1">Chapter 1</button></li>
					</ul>
				</section>
			</div>
		</section>
	</main>
	<script> 
	$(function() {
	  	$("#side").load("header.html"/*, () => {
	  		$('#content').show();
	  		$('#overlay').hide();
	  	}*/);
	});

	function setActive(e) {
		var currActive = document.getElementsByClassName("active")[0];
		currActive.classList.remove("active");
		e.classList.add("active");
	}

	const dateChapterRelease = new Date('5/27/2021');

	window.onload = (e) => {
		var countdown = document.getElementById('countdown');

		var daysLeft = getDaysUntilChapter(new Date());
		countdown.innerText = daysLeft == 0 ? " Today" : " in " + daysLeft + " days";
	};

	function getDaysUntilChapter(today) {
		var dayNum = today.getDay();
		var daysToFri = 5 - (dayNum < 5 ? dayNum : dayNum - 7);

		const diffTime = Math.abs(today - dateChapterRelease);
		const daysSinceChapter = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
		var mod = daysSinceChapter % 14;
		if (mod != 0 && mod < 7) {
			daysToFri += 7;
		}
		if (mod == 0) {
			daysToFri = 0;
		}

		return daysToFri;
	}

	$("button.read").click(function() {
		var chapterData = this.getAttribute("data").split("&");
		var chapterNumber = chapterData[1];

		const url = "https://cubari.moe/read/gist/Jsv4v/"+chapterNumber+"/1/";
		window.location.href = url;
	});

	var side = $("section#side")

	$("button#navtoggle").click(function() {
		side.toggleClass("shown");
	});
	</script>
</body>
